# 敵キャラ設定
* 敵キャラの設定はenemy_dbにある
* 敵キャラの画像サイズはenemy_dbに設定されている。
* enemy_dbには少なくとも `type`, `tip_file_name`, `width`, `height`, `notice_distance`, `giveup_distance` が必要である
* type=walkの場合は壁は通り抜けることができない。
* 高さが64px以上の敵キャラは、壁との当たり判定は上半分の32x32にはない。下半分の32x32に壁との当たり判定がある。
* 高さが32px以下の敵キャラは、全体に壁との当たり判定がある。
* type=flyの場合は壁を通り抜けることができる。（壁との当たり判定がない）
* プレイヤーの攻撃を受ける際の当たり判定は画像全体にある(32x64の場合は32x64全体)
* 気づく距離は `32px x notice_distance` である
* 追いかけるのをやめる距離は `32px x giveup_distance` である
* `giveup_distance < notice_distance` の場合でも挙動が不安定にならないよう、追跡解除距離は `max(giveup_distance, notice_distance)` を使う

# 敵キャラのチップ設定について
* 敵キャラの画像はenemy/enemy_tip内にある画像。1枚のpngにアニメーションがまとまっている
* 画像は歩行アニメーションが4行3列でまとめられた画像である。
* 1行目が下移動時、2行目が左移動時、3行目が右移動時、4行目が上移動時のアニメーションである。
* アニメーションは1列目をA、2列目をB、3列目をCとする。その場合アニメーションの順番はA→B→C→B→A→B→C→……とループする

# 敵キャラの移動について
* 敵の行動状態は `random_walk` と `chase` の2状態である
* プレイヤーに気づく前は `random_walk` で移動する
* `random_walk` は上下左右4方向のいずれかを選び、一定時間移動する。時間切れまたは衝突で方向を再抽選する
* プレイヤーに気づいた後は `chase` でプレイヤーを追いかける
* `chase` の速度は通常移動速度の1.3倍である
* `chase` は経路探索なしの直線追従で、目標はプレイヤー足元中心とする
* `walk` の追従移動は壁判定ありで、合成移動できないときはX軸/Y軸の単軸フォールバックを行う
* `fly` の追従移動は壁判定なし（壁を通過）で移動する
* 距離判定は「敵中心」と「プレイヤー足元中心」のユークリッド距離で行う
* `random_walk -> chase` の遷移条件は距離が `notice_distance` 以内であること
* ただし `walk` は上記に加えて視線が通っている必要がある（壁越しでは気づかない）
* `fly` は視線判定を行わず、距離のみで気づく
* `chase -> random_walk` の遷移条件は距離が `max(giveup_distance, notice_distance)` を超えること
* `walk` は一度追跡を開始した後、視線が切れても距離が `giveup` 内なら追跡を継続する
* 今フェーズでは追跡のみ実装対象であり、攻撃や接触ダメージ、プレイヤーとの物理衝突は実装しない

# 敵キャラの配置について（v1実装準拠）
* 敵は開始部屋には配置しない
* 開始部屋以外の各部屋に1体ずつ配置する（階段部屋を含む）
* 配置敵種はenemy_dbの定義（walk/fly）から選択する
