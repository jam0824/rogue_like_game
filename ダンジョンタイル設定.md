# ダンジョンの画像配置の例

ABBBBBC     ABBBBBC
DBBBBBE     DBBBBBE
DBBBBBE     DBBBBBE
DBBBBBE     DBBBBBE
DBBBBBE     DBBBBBE
D     E     D     E
D     E     D     E
D     FBBBBBG     E
D     FBBBBBG     E
D     FBBBBBG     E
D     FBBBBBG     E
D     FBBBBBG     E
D                 E
D     HIIIIIJ     E
D     E     D     E
D     E     D     E
D     E     D     E
KIIIIIL     KIIIIIL

## 記号の意味
1つの記号は32x32の画像である。

スペース : tile_normal.png (通行可能な地面)
A : left_top_01.png
B : top_01.png　ただしtop_01.pngは32x160であるため、縦にチップ5個分のサイズである。
C : right_top.png
D : left_01.png
E : right_01.png
F : left_top_corner.png　ただしleft_top_corner.pngは32x160であるため、縦にチップ5個分のサイズである。
G : right_top_corner.png　ただしright_top_corner.pngは32x160であるため、縦にチップ5個分のサイズである。
H : left_bottom_corner.png
I : bottom_01.png
J : right_bottom_corner.png
K : left_bottom_01.png
L : right_bottom_01.png

---

## 自動生成時のタイル判定ロジック（実装準拠）

本項目は、現在の実装コードに合わせた判定手順を明記したもの。

### 1. まず床グリッドを作る

- ダンジョン生成は最初に `floorGrid`（床=true / 非床=false）を作る。
- タイル記号（A-L）は `floorGrid` から後段で決定する。

### 2. 1次判定（4近傍の床判定）

- 非床セルのうち、上下左右のいずれかが床のセルだけを壁候補にする。
- 壁候補セルに対して、上下左右の床有無から一次記号を割り当てる。

主な割り当て:

- `down + right` -> `A`
- `down + left` -> `C`
- `up + right` -> `K`
- `up + left` -> `L`
- `left + right + down` -> `B`
- `left + right + up` -> `I`
- `up + down + right` -> `D`
- `up + down + left` -> `E`

### 3. 2次判定（角の補正）

1次判定結果を次で補正する。

- `A -> G`
- `C -> F`
- `K -> J`（条件）
  - 下側が壁、または
  - 下側がマップ外で、左側が壁
- `L -> H`（条件）
  - 下側が壁、または
  - 下側がマップ外で、右側が壁

### 4. 描画順

- 1) 地面（スペース）
- 2) 縦長壁（`B`, `F`, `G`）
- 3) 通常壁（`A`, `C`, `D`, `E`, `H`, `I`, `J`, `K`, `L`）

---

## 通路生成時の前提（縦長壁160px対応）

`B/F/G` が 32x160（5タイル高）であるため、横通路は次の前提で生成する。

- 横通路高さ: 6タイル（壁5 + 通行1）
- 縦通路幅: 2タイル
- 部屋間の最小ギャップは、縦長壁分（5タイル）を考慮する

この前提により、横通路上部で `B/F/G` が途中で切れないようにする。
